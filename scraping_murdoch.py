# pylint:skip-file

import re

import httpx
import pandas as pd

data = {
    "line": []
}

"""
8001-8080

9966-10001


['14098', '14172', '14256', '14345', '32146', '14388', '14440', '14478', '14511', '14843', '16047', '16162', '16302', '16486', '16570', '16657', '17332', '17477', '17563', '22883', '23003', '23379', '23492', '23689', '23825', '23978', '24066', '24369', '24665', '24803', '32146', '24912', '25019', '25099', '25570', '25686', '25833', '26033', '26187', '30248', '29025', '29153', '29308', '29415', '29575', '29743', '29902', '30014', '30128', '30490', '30610', '30706', '30902', '31028', '31159', '35003', '32146', '35004', '35005', '35207', '35208', '35209', '38246', '38247', '38248', '38249', '38250', '38251', '38252', '38253', '38254', '38256', '38257', '38265', '38258', '38259', '38260', '38261', '38280', '38283', '38289', '38290', '32146', '38287', '38291', '38286', '38285', '38245', '38288', '38255', '38282', '38293', '38262', '38281', '38294', '38284', '38292', '34345', '34358', '34459', '34628', '34856', '35002', '35206', '35291', '35354', '35646', '35681', '32146', '35721', '35781', '35810', '35855', '35934', '35980', '36019', '41443', '41579', '41619', '41760', '42049', '42197', '42558', '43028', '43162', '43277', '43419', '50182', '51430', '51670', '51962', '52272', '52805', '53994', '32146', '54327', '54743', '55402', '56061', '58829', '59546', '60761', '61413', '62152', '64598', '65046', '66345', '67378', '68030', '68543', '69226', '69499']
"""

for i in range(1, 79):
    print(f"Scraping Page {i}")
    transcript = httpx.request("GET", f"https://transcripts.foreverdreaming.org/viewtopic.php?f=13&t={8001 + i}")
    matches = re.findall(r"(?<=<p>).*?(?=<\/p)", transcript.text.replace("<br />\n", " "))
    for match in matches:
        match = re.sub(r'(\[|\()(.*?)(\]|\)|\):)', "" , match)
        match = re.sub(r'\b[A-Z]+[A-Z]\b: ', "", match).strip()
        match = match.replace("<script>).push;</script></div>", "")
        if not match == "" and not match.startswith("[") and not match.startswith("(") and not "&copy;" in match:
            data["line"].append(match)
    print("Scraping Complete")

for i in ('14098', '14172', '14256', '14345', '32146', '14388', '14440', '14478', '14511', '14843', '16047', '16162', '16302', '16486', '16570', '16657', '17332', '17477', '17563', '22883', '23003', '23379', '23492', '23689', '23825', '23978', '24066', '24369', '24665', '24803', '32146', '24912', '25019', '25099', '25570', '25686', '25833', '26033', '26187', '30248', '29025', '29153', '29308', '29415', '29575', '29743', '29902', '30014', '30128', '30490', '30610', '30706', '30902', '31028', '31159', '35003', '32146', '35004', '35005', '35207', '35208', '35209', '38246', '38247', '38248', '38249', '38250', '38251', '38252', '38253', '38254', '38256', '38257', '38265', '38258', '38259', '38260', '38261', '38280', '38283', '38289', '38290', '32146', '38287', '38291', '38286', '38285', '38245', '38288', '38255', '38282', '38293', '38262', '38281', '38294', '38284', '38292', '34345', '34358', '34459', '34628', '34856', '35002', '35206', '35291', '35354', '35646', '35681', '32146', '35721', '35781', '35810', '35855', '35934', '35980', '36019', '41443', '41579', '41619', '41760', '42049', '42197', '42558', '43028', '43162', '43277', '43419', '50182', '51430', '51670', '51962', '52272', '52805', '53994', '32146', '54327', '54743', '55402', '56061', '58829', '59546', '60761', '61413', '62152', '64598', '65046', '66345', '67378', '68030', '68543', '69226', '69499'):
    print(f"Scraping Page {i}")
    transcript = httpx.request("GET", f"https://transcripts.foreverdreaming.org/viewtopic.php?f=13&t={8001 + int(i)}")
    matches = re.findall(r"(?<=<p>).*?(?=<\/p)", transcript.text.replace("<br />\n", " "))
    for match in matches:
        match = re.sub(r'(\[|\()(.*?)(\]|\)|\):)', "" , match)
        match = re.sub(r'\b[A-Z]+[A-Z]\b: ', "", match).strip()
        match = match.replace("<script>).push;</script></div>", "")
        if not match == "" and not match.startswith("[") and not match.startswith("(") and not "&copy;" in match:
            data["line"].append(match)
    print("Scraping Complete")

df = pd.DataFrame(data)

df.to_csv("murdoch_full_transcripts.csv", index=False)
